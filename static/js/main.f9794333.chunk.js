(this["webpackJsonpscale-necklace"]=this["webpackJsonpscale-necklace"]||[]).push([[0],{122:function(e,t,n){},136:function(e,t,n){},141:function(e,t,n){"use strict";n.r(t);var a=n(16),c=n(7),r=n.n(c),o=n(30),i=n.n(o),l=(n(122),n(11)),u=n(8),s=n(50),f=n(10),d=n(33),h=[{sharp:"c",flat:"c"},{sharp:"c#",flat:"db"},{sharp:"d",flat:"d"},{sharp:"d#",flat:"eb"},{sharp:"e",flat:"e"},{sharp:"f",flat:"f"},{sharp:"f#",flat:"gb"},{sharp:"g",flat:"g"},{sharp:"g#",flat:"ab"},{sharp:"a",flat:"a"},{sharp:"a#",flat:"bb"},{sharp:"b",flat:"b"}];function b(e){return e<=1?[]:Object(d.flatten)([j(e-1).map((function(e){return{head:[1],tail:e}})),j(e-2).map((function(e){return{head:[1,1],tail:e}}))]).map((function(e){return{tag:"A",scale:e}}))}function j(e){return e<=0?[]:Object(d.flatten)([b(e-3).map((function(e){return{head:[3],tail:e}})),p(e-2).map((function(e){return{head:[2],tail:e}})),p(e-5).map((function(e){return{head:[2,3],tail:e}}))]).map((function(e){return{tag:"B",scale:e}}))}function p(e){return e<0?[]:0===e?[{tag:"C",scale:null}]:Object(d.flatten)([b(e),j(e)]).map((function(e){return{tag:"C",scale:e}}))}function g(e){var t=e.scale.head;return null===e.scale.tail?t:t.concat(m(e.scale.tail))}function m(e){var t=e.scale.head;switch(e.scale.tail.tag){case"A":return t.concat(g(e.scale.tail));case"C":return t.concat(O(e.scale.tail))}}function O(e){if(null===e.scale)return[];switch(e.scale.tag){case"A":return g(e.scale);case"B":return m(e.scale)}}function v(e){return Object(d.zip)(e,e.slice(1)).some((function(e){var t=Object(f.a)(e,2),n=t[0],a=t[1];return 1===n&&1===a}))}function y(e){return e.some((function(e){return 3===e}))}var w=p(h.length).map(O),x=n(51),k=n(59),P=(n(136),n(42)),C=n(43),S=n(159),E=n(160),R=getComputedStyle(document.documentElement).getPropertyValue("--hl"),T=getComputedStyle(document.documentElement).getPropertyValue("--ll"),M=getComputedStyle(document.documentElement).getPropertyValue("--pl");function L(e){return Math.floor(Math.random()*e)}function z(e,t){var n=A(t,e.length);return e.slice(n).concat(e.slice(0,n))}function A(e,t){return(e%t+t)%t}function I(e){return A(e,h.length)}function N(e,t){var n=r.a.useRef(null);if(null==n.current)return n.current=e,e;var a=Math.round((n.current-e)/t)*t+e;return n.current=a,a}var B=function(e,t){var n,a=w.filter(Math.random()<e?y:function(e){return!y(e)}).filter(Math.random()<t?v:function(e){return!v(e)});return(n=a)[L(n.length)]};function F(e){return 100*w.filter(e).length/w.length}var V=n(157);function D(){var e=r.a.useState(0),t=Object(f.a)(e,2),n=t[0],c=t[1],o=r.a.useState(0),i=Object(f.a)(o,2),d=i[0],b=i[1],j=r.a.useState(!0),p=Object(f.a)(j,2),g=p[0],m=p[1],O=r.a.useState(F(v)),w=Object(f.a)(O,2),A=w[0],D=w[1],H=r.a.useState(F(y)),J=Object(f.a)(H,2),W=J[0],$=J[1],q=r.a.useState(B(W,A)),G=Object(f.a)(q,2),K=G[0],Q=G[1],U=r.a.useState({loaded:!1}),X=Object(f.a)(U,2),Y=X[0],Z=X[1],_=r.a.useState({width:window.innerWidth,height:window.innerHeight}),ee=Object(f.a)(_,2),te=ee[0],ne=te.width,ae=te.height,ce=ee[1],re=r.a.useMemo((function(){return new x.a}),[]),oe=N(d,h.length),ie=N(n,h.length),le=Object(P.b)({springRoot:oe,springOffset:ie,config:{tension:200,friction:120,mass:10}}),ue=le.springRoot,se=le.springOffset,fe=Y.loaded&&Y.notesToPlay.length>0;r.a.useEffect((function(){var e=function(){return ce({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[ce]),r.a.useEffect((function(){var e=function(e){var t=e.key;"Shift"===t&&m(!1),"Enter"===t&&m(!g)},t=function(e){"Shift"===e.key&&m(!0)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),function(){window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}}),[g,m]),r.a.useEffect((function(){if(Y.loaded){var e=Object(s.a)(Y.notesToPlay),t=e[0],n=e.slice(1);if(fe){var a,c=h[t%h.length];return re.triggerAttack("".concat(c.sharp).concat(t<h.length?3:4)),a=setInterval((function(){Z(Object(u.a)(Object(u.a)({},Y),{},{notesToPlay:n}))}),300),function(){re.triggerRelease(),a&&clearInterval(a)}}}else re.toDestination(),Z({loaded:!0,notesToPlay:[]})}),[Y,fe]);var de=Math.min(ne-30,ae-30),he=2*Math.PI/h.length,be=k.a().padAngle(.1).innerRadius(de/2.9).outerRadius(de/2).startAngle((function(e){return(e-.5)*he})).endAngle((function(e){return(e+.5)*he})).cornerRadius(de),je=h.map((function(e,t){return be(t)})),pe={"--f":"".concat(de/50,"pt")},ge=function(e){Y.loaded&&(fe?Z(Object(u.a)(Object(u.a)({},Y),{},{notesToPlay:[]})):Object(x.b)().then((function(){return Z(Object(u.a)(Object(u.a)({},Y),{},{notesToPlay:e}))})))},me=K.reduce((function(e,t){return e.concat(e[e.length-1]+t)}),[d]),Oe=me.map((function(e){return e%h.length})),ve=h.map((function(e,t){return Oe.includes(t)})),ye=ve.map((function(e,t){return Y.loaded&&Y.notesToPlay.length>0&&I(Y.notesToPlay[0])===t?M:e?R:T})),we=Object(C.a)(z(Object(C.a)(ve,ye).map((function(e,t){var n=Object(s.a)(e).slice(0);return[t].concat(Object(l.a)(n))})),d-n),je),xe=h.map((function(e){return e.sharp===e.flat?e.sharp:"".concat(e.sharp,"/").concat(e.flat).replace(/(\w)#/,"$1\u266f").replace(/(\w)b/,"$1\u266d")})),ke=z(Object(C.a)(xe,ye),d),Pe=function(){return Q(B(W,A))};return Object(a.jsxs)("div",{className:"container",style:{"--s":"".concat(de,"px"),"--m":h.length},children:[Object(a.jsxs)("div",{className:"buttons",children:[Object(a.jsx)("button",{style:pe,onClick:function(){b(L(h.length)),c(0),ge([])},children:"Randomize Root"}),Object(a.jsx)("button",{style:pe,onClick:Pe,children:"Randomize Scale"}),Object(a.jsx)("button",{style:pe,onClick:Pe,children:"Random adjacent Scale"}),Object(a.jsx)("button",{style:pe,onClick:function(){return ge(me)},"aria-pressed":fe,children:fe?"Pause":"Play"}),Object(a.jsxs)("div",{style:{zIndex:1e3},children:[Object(a.jsx)(V.a,{style:Object(u.a)(Object(u.a)({},pe),{},{color:"#999999"}),children:"Click on a note or shift-click on a yellow note."}),Object(a.jsx)(S.a,{checked:!g,onChange:function(e){var t=e.target;return m(!t.checked)},color:"default",size:"medium",inputProps:{"aria-label":"toggle movement mode",role:"switch"}}),Object(a.jsx)(V.a,{children:"Probability of consecutive half-steps"}),Object(a.jsx)(E.a,{value:A,onChange:function(e,t){return D(t)}}),Object(a.jsx)(V.a,{children:"Probability of augmented 2nd"}),Object(a.jsx)(E.a,{value:W,onChange:function(e,t){return $(t)}})]})]}),Object(a.jsxs)(P.a.div,{className:"necklace",style:{"--r":se.interpolate((function(e){return-e}))},children:[we.map((function(e,t){var r=Object(f.a)(e,2),o=Object(f.a)(r[0],3),i=o[0],l=o[1],u=o[2],s=r[1];return Object(a.jsx)("svg",{className:"svg",style:{"--c":u},children:Object(a.jsx)("path",{className:"path",stroke:u,d:s,"aria-labelledby":"note".concat(i),role:"button",tabIndex:0,onClick:function(){var e=I(n+(i-d));g?b(i):l&&(c(e),Q(z(K,Oe.indexOf(i))))}})},t)})),Object(a.jsx)(P.a.div,{className:"note-names",style:{"--a":ue.interpolate((function(e){return d-e}))},children:ke.map((function(e,t){var n=Object(f.a)(e,2),c=n[0],r=n[1];return Object(a.jsx)("span",{style:Object(u.a)({"--i":t,"--c":r},pe),id:"note".concat(d+t),children:c},t)}))})]})]})}var H=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,162)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),a(e),c(e),r(e),o(e)}))};i.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(D,{})}),document.getElementById("root")),H()}},[[141,1,2]]]);
//# sourceMappingURL=main.f9794333.chunk.js.map