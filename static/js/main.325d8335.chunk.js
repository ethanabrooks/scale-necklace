(this["webpackJsonpscale-necklace"]=this["webpackJsonpscale-necklace"]||[]).push([[0],{104:function(t,e,n){},123:function(t,e,n){},124:function(t,e,n){"use strict";n.r(e);var a=n(12),r=n(9),c=n.n(r),u=n(43),i=n.n(u),o=(n(104),n(10)),l=n(18),s=n(7),f=n(8),d=n(19),h=[{sharp:"c",flat:"c"},{sharp:"c#",flat:"db"},{sharp:"d",flat:"d"},{sharp:"d#",flat:"eb"},{sharp:"e",flat:"e"},{sharp:"f",flat:"f"},{sharp:"f#",flat:"gb"},{sharp:"g",flat:"g"},{sharp:"g#",flat:"ab"},{sharp:"a",flat:"a"},{sharp:"a#",flat:"bb"},{sharp:"b",flat:"b"}],b=h.length,j=n(22),p=n.n(j),m=getComputedStyle(document.documentElement).getPropertyValue("--hl"),g=getComputedStyle(document.documentElement).getPropertyValue("--fg"),O=(getComputedStyle(document.documentElement).getPropertyValue("--ll"),getComputedStyle(document.documentElement).getPropertyValue("--pl"));function v(t){return Math.floor(Math.random()*t)}function y(t,e){var n=w(e,t.length);return t.slice(n).concat(t.slice(0,n))}function w(t,e){return(t%e+e)%e}function x(t){return w(t,h.length)}function k(t,e){var n=c.a.useRef(null);if(null==n.current)return n.current=t,t;var a=Math.round((n.current-t)/e)*e+t;return n.current=a,a}var P=function(t,e,n){var a,r=t.filter(Math.random()<e?L:function(t){return!L(t)}).filter(Math.random()<n?V:function(t){return!V(t)});return p()(r.length>0),(a=r)[v(a.length)]};function C(t){return 100*I.filter(t).length/I.length}function N(t){return t<=1?[]:Object(d.flatten)([S(t-1).map((function(t){return{head:[1],tail:t}})),S(t-2).map((function(t){return{head:[1,1],tail:t}}))]).map((function(t){return{tag:"A",scale:t}}))}function S(t){return t<=0?[]:Object(d.flatten)([N(t-3).map((function(t){return{head:[3],tail:t}})),E(t-2).map((function(t){return{head:[2],tail:t}})),E(t-5).map((function(t){return{head:[2,3],tail:t}}))]).map((function(t){return{tag:"B",scale:t}}))}function E(t){return t<0?[]:0===t?[{tag:"C",scale:null}]:Object(d.flatten)([N(t),S(t)]).map((function(t){return{tag:"C",scale:t}}))}function R(t){var e=t.scale.head;return null===t.scale.tail?e:e.concat(T(t.scale.tail))}function T(t){var e=t.scale.head;switch(t.scale.tail.tag){case"A":return e.concat(R(t.scale.tail));case"C":return e.concat(M(t.scale.tail))}}function M(t){if(null===t.scale)return[];switch(t.scale.tag){case"A":return R(t.scale);case"B":return T(t.scale)}}function V(t){return Object(d.zip)(t,y(t,1)).some((function(t){var e=Object(f.a)(t,2),n=e[0],a=e[1];return 1===n&&1===a}))}function L(t){return t.some((function(t){return 3===t}))}function A(t,e){return Object(d.zip)(t,e).every((function(t){var e=Object(f.a)(t,2);return e[0]===e[1]}))}function z(t,e,n,a){if(0===t.length||0===e.length)return!1;var r=Object(l.a)(t),c=r[0],u=r.slice(1),i=Object(l.a)(e),o=i[0],s=i.slice(1);if(p()(c===n[n.length-1]),p()(o===a[a.length-1]),c===o){var f,d=Object(l.a)(n),h=d[0],b=d[1],j=d.slice(2),m=Object(l.a)(a),g=m[0],O=m[1],v=m.slice(2);if(h===O&&b===g&&(f=A(j,v)),h+b===g&&(f=A(j,[O].concat(v))),g+O===h&&(f=A(v,[b].concat(j))),f)return!0}return z(u,s,y(n,1),y(a,1))}var I=Object(d.flatten)(E(b).map(M).map((function(t){return t.map((function(e,n){return y(t,n)}))})));function B(t){return I.filter((function(e){return function(t,e){return z(t,e,y(t,1),y(e,1))}(t,e)}))}var F=n(36),D=n(44),H=(n(123),n(30)),J=n(29),W=function(t){var e=t.value,n=t.setValue;return Object(a.jsx)("input",{type:"range",className:"slider",min:0,max:100,value:e,onChange:function(t){var e=t.target;n(+e.value)}})},$=function(t){var e=t.value,n=t.setValue;return Object(a.jsxs)("label",{className:"switch",children:[Object(a.jsx)("input",{type:"checkbox",onClick:function(){return n(!e)},defaultChecked:!e}),Object(a.jsx)("span",{className:"slide"})]})};function q(){var t=c.a.useState(0),e=Object(f.a)(t,2),n=e[0],r=e[1],u=c.a.useState(0),i=Object(f.a)(u,2),d=i[0],b=i[1],j=c.a.useState(!0),p=Object(f.a)(j,2),w=p[0],N=p[1],S=c.a.useState(C(V)),E=Object(f.a)(S,2),R=E[0],T=E[1],M=c.a.useState(C(L)),A=Object(f.a)(M,2),z=A[0],q=A[1],G=c.a.useState(P(I,z,R)),K=Object(f.a)(G,2),Q=K[0],U=K[1],X=c.a.useState({width:window.innerWidth,height:window.innerHeight}),Y=Object(f.a)(X,2),Z=Y[0],_=Z.width,tt=Z.height,et=Y[1],nt=c.a.useMemo((function(){return new F.a}),[]),at=k(d,h.length),rt=k(n,h.length),ct=Object(H.b)({springRoot:at,springOffset:rt,config:{tension:200,friction:120,mass:10}}),ut=ct.springRoot,it=ct.springOffset,ot=c.a.useReducer((function(t,e){if(t.loaded){if("play"==e.type)return Object(s.a)(Object(s.a)({},t),{},{notesToPlay:e.notes});if("nextNote"==e.type){var n=Object(l.a)(t.notesToPlay),a=(n[0],n.slice(1));return Object(s.a)(Object(s.a)({},t),{},{notesToPlay:a})}if("reset"==e.type)return Object(s.a)(Object(s.a)({},t),{},{notesToPlay:[]});throw 1}return{loaded:!0,notesToPlay:[]}}),{loaded:!1}),lt=Object(f.a)(ot,2),st=lt[0],ft=lt[1];c.a.useEffect((function(){if(st.loaded){if(dt){var t,e=Object(f.a)(st.notesToPlay,1)[0],n=h[e%h.length];return nt.triggerAttack("".concat(n.sharp).concat(e<h.length?ht:ht+1)),t=setInterval((function(){ft({type:"nextNote"})}),500),function(){nt.triggerRelease(),t&&clearInterval(t)}}}else nt.toDestination(),ft({type:"reset"})}),[st,nt]);var dt=st.loaded&&st.notesToPlay.length>0,ht=3;c.a.useEffect((function(){var t=function(){return et({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",t),function(){window.removeEventListener("resize",t)}}),[]),c.a.useEffect((function(){var t=function(t){var e=t.key;"Shift"===e&&N(!1),"Enter"===e&&N((function(t){return!t}))},e=function(t){"Shift"===t.key&&N(!0)};return window.addEventListener("keydown",t),window.addEventListener("keyup",e),function(){window.removeEventListener("keydown",t),window.removeEventListener("keyup",e)}}),[]);var bt=Math.min(_-30,tt-30),jt=2*Math.PI/h.length,pt=D.a().padAngle(.1).innerRadius(bt/2.9).outerRadius(bt/2).startAngle((function(t){return(t-.5)*jt})).endAngle((function(t){return(t+.5)*jt})).cornerRadius(bt),mt=h.map((function(t,e){return pt(e)})),gt=function(t){st.loaded&&(dt?ft({type:"reset"}):Object(F.b)().then((function(){return ft({type:"play",notes:t})})))},Ot=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.reduce((function(t,e){return t.concat(t[t.length-1]+e)}),[e])}(Q,d),vt=Ot.map((function(t){return t%h.length})),yt=h.map((function(t,e){return vt.includes(e)})),wt=yt.map((function(t,e){return st.loaded&&st.notesToPlay.length>0&&x(st.notesToPlay[0])===e?O:t?m:g})),xt=Object(J.a)(y(Object(J.a)(yt,wt).map((function(t,e){var n=Object(l.a)(t).slice(0);return[e].concat(Object(o.a)(n))})),d-n),mt),kt=h.map((function(t){return t.sharp===t.flat?t.sharp:"".concat(t.sharp,"/").concat(t.flat).replace(/(\w)#/,"$1\u266f").replace(/(\w)b/,"$1\u266d")})),Pt=y(Object(J.a)(kt,wt),d);return Object(a.jsxs)("div",{className:"container",style:{"--s":"".concat(bt,"px"),"--m":h.length},children:[Object(a.jsxs)("div",{className:"buttons",children:[Object(a.jsx)("button",{className:"button",onClick:function(){b(v(h.length)),r(0),gt([])},children:"Randomize Root"}),Object(a.jsx)("button",{className:"button",onClick:function(){return U(P(I,z,R))},children:"Randomize Scale"}),Object(a.jsx)("button",{className:"button",onClick:function(){var t=B(Q);return U(P(t,z,R))},children:"Random adjacent Scale"}),Object(a.jsx)("button",{className:"button",onClick:function(){return gt(Ot)},"aria-pressed":dt,children:dt?"Pause":"Play"}),Object(a.jsx)("span",{className:"static",children:"Click on a note or shift-click on a yellow note."}),Object(a.jsx)($,{value:w,setValue:N}),Object(a.jsx)("span",{className:"static",children:"Probability of consecutive half-steps"}),Object(a.jsx)(W,{value:R,setValue:T}),Object(a.jsx)("span",{className:"static",children:"Probability of augmented 2nd"}),Object(a.jsx)(W,{value:z,setValue:q})]}),Object(a.jsxs)(H.a.div,{className:"necklace",style:{"--r":it.interpolate((function(t){return-t}))},children:[xt.map((function(t,e){var c=Object(f.a)(t,2),u=Object(f.a)(c[0],3),i=u[0],o=u[1],l=u[2],s=c[1];return Object(a.jsx)("svg",{className:"svg",style:{"--c":l},children:Object(a.jsx)("path",{className:"path",stroke:l,d:s,"aria-labelledby":"note".concat(i),role:"button",tabIndex:0,onClick:function(){var t=x(n+(i-d));w?b(i):o&&(r(t),U(y(Q,vt.indexOf(i))))}})},e)})),Object(a.jsx)(H.a.div,{className:"note-names",style:{"--a":ut.interpolate((function(t){return d-t}))},children:Pt.map((function(t,e){var n=Object(f.a)(t,2),r=n[0],c=n[1];return Object(a.jsx)("span",{style:{"--i":e,"--c":c},id:"note".concat(d+e),children:r},e)}))})]})]})}var G=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,125)).then((function(e){var n=e.getCLS,a=e.getFID,r=e.getFCP,c=e.getLCP,u=e.getTTFB;n(t),a(t),r(t),c(t),u(t)}))};i.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(q,{})}),document.getElementById("root")),G()}},[[124,1,2]]]);
//# sourceMappingURL=main.325d8335.chunk.js.map