(this["webpackJsonpscale-necklace"]=this["webpackJsonpscale-necklace"]||[]).push([[0],{104:function(e,t,n){},123:function(e,t,n){},124:function(e,t,n){"use strict";n.r(t);var a=n(12),c=n(9),r=n.n(c),i=n(43),l=n.n(i),o=(n(104),n(10)),s=n(18),u=n(6),f=n(8),d=n(19),h=[{sharp:"c",flat:"c"},{sharp:"c#",flat:"db"},{sharp:"d",flat:"d"},{sharp:"d#",flat:"eb"},{sharp:"e",flat:"e"},{sharp:"f",flat:"f"},{sharp:"f#",flat:"gb"},{sharp:"g",flat:"g"},{sharp:"g#",flat:"ab"},{sharp:"a",flat:"a"},{sharp:"a#",flat:"bb"},{sharp:"b",flat:"b"}],b=h.length,j="#fca311",p="#e5e5e5",g="#ff4136";function O(e){return Math.floor(Math.random()*e)}function v(e){return e[O(e.length)]}function m(e,t){var n=w(t,e.length);return e.slice(n).concat(e.slice(0,n))}function w(e,t){return(e%t+t)%t}function x(e){return w(e,h.length)}function y(e,t){var n=r.a.useRef(null);if(null==n.current)return n.current=e,e;var a=Math.round((n.current-e)/t)*t+e;return n.current=a,a}var N=function(e,t,n){var a,c=e.filter(L),r=e.filter((function(e){return!L(e)}));if((100*Math.random()<t||0===r.length)&&c.length>0)0===t&&alert("No adjacent scale without augmented seconds."),a=c;else{if(!(r.length>0))return null;a=r}var i=a.filter(A),l=a.filter((function(e){return!A(e)}));return(100*Math.random()<n||0===l.length)&&i.length>0?(0===n&&alert("No adjacent scale without double half steps."),v(i)):l.length>0?v(l):null};function k(e){return 100*F.filter(e).length/F.length}var C=n(35),P=n.n(C);function S(e){return e<=1?[]:Object(d.flatten)([R(e-1).map((function(e){return{head:[1],tail:e}})),R(e-2).map((function(e){return{head:[1,1],tail:e}}))]).map((function(e){return{tag:"A",scale:e}}))}function R(e){return e<=0?[]:Object(d.flatten)([S(e-3).map((function(e){return{head:[3],tail:e}})),E(e-2).map((function(e){return{head:[2],tail:e}})),E(e-5).map((function(e){return{head:[2,3],tail:e}}))]).map((function(e){return{tag:"B",scale:e}}))}function E(e){return e<0?[]:0===e?[{tag:"C",scale:null}]:Object(d.flatten)([S(e),R(e)]).map((function(e){return{tag:"C",scale:e}}))}function T(e){var t=e.scale.head;return null===e.scale.tail?t:t.concat(z(e.scale.tail))}function z(e){var t=e.scale.head;switch(e.scale.tail.tag){case"A":return t.concat(T(e.scale.tail));case"C":return t.concat(M(e.scale.tail))}}function M(e){if(null===e.scale)return[];switch(e.scale.tag){case"A":return T(e.scale);case"B":return z(e.scale)}}function A(e){return Object(d.zip)(e,m(e,1)).some((function(e){var t=Object(f.a)(e,2),n=t[0],a=t[1];return 1===n&&1===a}))}function L(e){return e.some((function(e){return 3===e}))}function I(e,t){return Object(d.zip)(e,t).every((function(e){var t=Object(f.a)(e,2);return t[0]===t[1]}))}function V(e,t,n,a){if(0===e.length||0===t.length)return!1;var c=Object(s.a)(e),r=c[0],i=c.slice(1),l=Object(s.a)(t),o=l[0],u=l.slice(1);if(P()(r===n[n.length-1]),P()(o===a[a.length-1]),r===o){var f,d=Object(s.a)(n),h=d[0],b=d[1],j=d.slice(2),p=Object(s.a)(a),g=p[0],O=p[1],v=p.slice(2);if(h!==b&&h+b===g+O&&(f=I(j,v)),h+b===g&&(f=I(j,[O].concat(v))),g+O===h&&(f=I(v,[b].concat(j))),f)return!0}return V(i,u,m(n,1),m(a,1))}function B(e,t){return V(e,t,m(e,1),m(t,1))}var F=Object(d.flatten)(E(b).map(M).map((function(e){return e.map((function(t,n){return m(e,n)}))})));var q=n(36),D=n(44),H=(n(123),n(29)),J=n(28),W=function(e){var t=e.value,n=e.setValue;return Object(a.jsx)("label",{className:"relative",children:Object(a.jsx)("input",{type:"range",className:"width-100 slide center absolute",min:0,max:100,step:10,value:t,onChange:function(e){var t=e.target;n(+t.value)}})})},$=function(e){var t=e.value,n=e.setValue;return Object(a.jsxs)("label",{className:"relative",children:[Object(a.jsx)("input",{className:"invisible",type:"checkbox",onChange:function(){return n(!t)},checked:!t}),Object(a.jsx)("span",{className:"slide switch absolute center"})]})};function G(){var e=r.a.useState(0),t=Object(f.a)(e,2),n=t[0],c=t[1],i=r.a.useState([{root:0,steps:F[0]}]),l=Object(f.a)(i,2),d=l[0],b=l[1],v=r.a.useState(0),w=Object(f.a)(v,2),C=w[0],P=w[1],S=d[C],R=S.root;function E(e){P(d.length),b(d.concat(e))}var T=r.a.useState(!0),z=Object(f.a)(T,2),M=z[0],I=z[1],V=r.a.useState(k(A)),G=Object(f.a)(V,2),K=G[0],Q=G[1],U=r.a.useState(k(L)),X=Object(f.a)(U,2),Y=X[0],Z=X[1],_=r.a.useState({width:window.innerWidth,height:window.innerHeight}),ee=Object(f.a)(_,2),te=ee[0],ne=te.width,ae=te.height,ce=ee[1],re=r.a.useMemo((function(){return new q.a}),[]),ie=y(R,h.length),le=y(n,h.length),oe=Object(H.b)({springRoot:ie,springOffset:le,config:{tension:200,friction:120,mass:10}}),se=oe.springRoot,ue=oe.springOffset,fe=r.a.useReducer((function(e,t){if(e.loaded){if("play"===t.type)return Object(u.a)(Object(u.a)({},e),{},{notesToPlay:t.notes});if("nextNote"===t.type){var n=Object(s.a)(e.notesToPlay).slice(1);return Object(u.a)(Object(u.a)({},e),{},{notesToPlay:n})}if("reset"===t.type)return Object(u.a)(Object(u.a)({},e),{},{notesToPlay:[]});throw new Error("Invalid action.type")}return{loaded:!0,notesToPlay:[]}}),{loaded:!1}),de=Object(f.a)(fe,2),he=de[0],be=de[1],je=he.loaded&&he.notesToPlay.length>0;r.a.useEffect((function(){if(he.loaded){if(je){var e,t=Object(f.a)(he.notesToPlay,1)[0],n=h[t%h.length];return re.triggerAttack("".concat(n.sharp).concat(t<h.length?3:4)),e=setInterval((function(){be({type:"nextNote"})}),500),function(){re.triggerRelease(),e&&clearInterval(e)}}}else re.toDestination(),be({type:"reset"})}),[he,re,je]),r.a.useEffect((function(){var e=function(){return ce({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),r.a.useEffect((function(){var e=function(e){var t=e.key;"Shift"===t&&I(!1),"m"===t&&I((function(e){return!e}))},t=function(e){"Shift"===e.key&&I(!0)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),function(){window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}}),[I]);var pe=Math.min(ne-30,ae-30),ge=2*Math.PI/h.length,Oe=D.a().padAngle(.1).innerRadius(pe/2.9).outerRadius(pe/2).startAngle((function(e){return(e-.5)*ge})).endAngle((function(e){return(e+.5)*ge})).cornerRadius(pe),ve=h.map((function(e,t){return Oe(t)})),me=function(e){he.loaded&&(je?be({type:"reset"}):Object(q.b)().then((function(){return be({type:"play",notes:e})})))},we=S.steps,xe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.reduce((function(e,t){return e.concat(e[e.length-1]+t)}),[t])}(we,R),ye=xe.map((function(e){return e%h.length})),Ne=h.map((function(e,t){return ye.includes(t)})),ke=Ne.map((function(e,t){return he.loaded&&he.notesToPlay.length>0&&x(he.notesToPlay[0])===t?g:e?j:p})),Ce=Object(J.a)(m(Object(J.a)(Ne,ke).map((function(e,t){var n=Object(s.a)(e).slice(0);return[t].concat(Object(o.a)(n))})),R-n),ve),Pe=h.map((function(e){return e.sharp===e.flat?e.sharp:"".concat(e.sharp,"/").concat(e.flat).replace(/(\w)#/,"$1\u266f").replace(/(\w)b/,"$1\u266d")})),Se=m(Object(J.a)(Pe,ke),R),Re="button large-font z-1000 no-border curved-radius auto-margin",Ee="low-light-color medium-font auto-margin";function Te(e){return function(t){return(e-t)/Pe.length-1/4}}return Object(a.jsxs)("div",{className:"relative",style:{"--containerSize":"".concat(pe,"px"),"--m":h.length,"--fg":p,"--hl":j,"--ll":"#999999","--pl":g},children:[Object(a.jsx)("div",{id:"noteSequence","aria-live":"assertive",className:"absolute z-1000 invisible",tabIndex:0,children:ye.map((function(e){return Pe[e].split("/")[0]})).join(",")}),Object(a.jsxs)("div",{className:"absolute",children:[Object(a.jsx)("button",{className:Re,onClick:function(){return P(C-1)},disabled:0===C,children:"\u21e6"}),Object(a.jsx)("button",{className:Re,onClick:function(){return P(C+1)},disabled:C===d.length-1,children:"\u21e8"})]}),Object(a.jsx)("div",{className:"fixed center height-necklace width-100-percent",children:Object(a.jsxs)("div",{className:"column space-around center-text absolute",children:[Object(a.jsx)("button",{className:Re,onClick:function(){var e=O(h.length);E(Object(u.a)(Object(u.a)({},S),{},{root:e})),c(0),me([])},children:"Randomize Root"}),Object(a.jsx)("button",{className:Re,onClick:function(){var e=N(F,Y,K);null===e?alert("No valid scale."):E(Object(u.a)(Object(u.a)({},S),{},{steps:e}))},children:"Randomize Scale"}),Object(a.jsx)("button",{className:Re,onClick:function(){var e=function(e){return F.filter((function(t){return B(e,t)}))}(we),t=N(e,Y,K);null===t?(alert("No adjacent scale possible."),console.log(we)):E(Object(u.a)(Object(u.a)({},S),{},{steps:t}))},children:"Random Adjacent Scale"}),Object(a.jsx)("button",{className:Re,onClick:function(){return me(xe)},"aria-pressed":je,children:je?"Pause":"Play"}),Object(a.jsx)("span",{className:Ee,children:"Click on a note or shift-click on a yellow note."}),Object(a.jsx)($,{value:M,setValue:I}),Object(a.jsx)("span",{className:Ee,children:"Probability of consecutive half-steps"}),Object(a.jsx)(W,{value:K,setValue:Q}),Object(a.jsx)("span",{className:Ee,children:"Probability of augmented 2nd"}),Object(a.jsx)(W,{value:Y,setValue:Z})]})}),Object(a.jsx)("div",{className:"fixed center",children:Object(a.jsxs)("div",{className:"absolute width-100-percent height-100-percent",children:[Ce.map((function(e,t){var r=Object(f.a)(e,2),i=Object(f.a)(r[0],3),l=i[0],o=i[1],s=i[2];r[1];return Object(a.jsx)(H.a.button,{"aria-controls":"noteSequence",className:"offset-angle pearl-shape button border-color","aria-label":Pe[l],style:{"--color":s,"--turn":ue.interpolate(Te(t))},onClick:function(){var e=x(n+(l-R));if(M)E(Object(u.a)(Object(u.a)({},S),{},{root:l}));else if(o){c(e);var t=m(we,ye.indexOf(l));E(Object(u.a)(Object(u.a)({},S),{},{steps:t}))}}})})),Object(a.jsx)("div",{className:"absolute width-100-percent height-100-percent",children:Se.map((function(e,t){var n=Object(f.a)(e,2),c=n[0],r=n[1];return Object(a.jsx)(H.a.span,{className:"offset-angle text-color diff-blend-mode no-pointer-events medium-font",style:{"--turn":se.interpolate(Te(t+R)),"--color":r},id:"note".concat(R+t),children:c},t)}))})]})})]})}var K=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,125)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),r(e),i(e)}))};l.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(G,{})}),document.getElementById("root")),K()}},[[124,1,2]]]);
//# sourceMappingURL=main.9170d03b.chunk.js.map