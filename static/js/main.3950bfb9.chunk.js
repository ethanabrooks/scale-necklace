(this["webpackJsonpscale-necklace"]=this["webpackJsonpscale-necklace"]||[]).push([[0],{122:function(t,e,n){},136:function(t,e,n){},141:function(t,e,n){"use strict";n.r(e);var a=n(16),c=n(7),r=n.n(c),o=n(30),i=n.n(o),u=(n(122),n(11)),l=n(8),s=n(50),f=n(10),d=n(33),h=[{sharp:"c",flat:"c"},{sharp:"c#",flat:"db"},{sharp:"d",flat:"d"},{sharp:"d#",flat:"eb"},{sharp:"e",flat:"e"},{sharp:"f",flat:"f"},{sharp:"f#",flat:"gb"},{sharp:"g",flat:"g"},{sharp:"g#",flat:"ab"},{sharp:"a",flat:"a"},{sharp:"a#",flat:"bb"},{sharp:"b",flat:"b"}],b=h.length;function j(t){return t<=1?[]:Object(d.flatten)([g(t-1).map((function(t){return{head:[1],tail:t}})),g(t-2).map((function(t){return{head:[1,1],tail:t}}))]).map((function(t){return{tag:"A",scale:t}}))}function g(t){return t<=0?[]:Object(d.flatten)([j(t-3).map((function(t){return{head:[3],tail:t}})),p(t-2).map((function(t){return{head:[2],tail:t}})),p(t-5).map((function(t){return{head:[2,3],tail:t}}))]).map((function(t){return{tag:"B",scale:t}}))}function p(t){return t<0?[]:0===t?[{tag:"C",scale:null}]:Object(d.flatten)([j(t),g(t)]).map((function(t){return{tag:"C",scale:t}}))}function m(t){var e=t.scale.head;return null===t.scale.tail?e:e.concat(O(t.scale.tail))}function O(t){var e=t.scale.head;switch(t.scale.tail.tag){case"A":return e.concat(m(t.scale.tail));case"C":return e.concat(v(t.scale.tail))}}function v(t){if(null===t.scale)return[];switch(t.scale.tag){case"A":return m(t.scale);case"B":return O(t.scale)}}function y(t){return Object(d.zip)(t,t.slice(1)).some((function(t){var e=Object(f.a)(t,2),n=e[0],a=e[1];return 1===n&&1===a}))}function w(t){return t.some((function(t){return 3===t}))}function x(){return p(b).map(v)}var k=n(51),P=n(59),C=(n(136),n(42)),S=n(43),E=n(159),M=n(160),R=getComputedStyle(document.documentElement).getPropertyValue("--hl"),T=getComputedStyle(document.documentElement).getPropertyValue("--ll"),L=getComputedStyle(document.documentElement).getPropertyValue("--pl");function z(t){return Math.floor(Math.random()*t)}function A(t,e){var n=I(e,t.length);return t.slice(n).concat(t.slice(0,n))}function I(t,e){return(t%e+e)%e}function N(t){return I(t,h.length)}function B(t,e){var n=r.a.useRef(null);if(null==n.current)return n.current=t,t;var a=Math.round((n.current-t)/e)*e+t;return n.current=a,a}var F=n(157);function V(){var t=r.a.useMemo(x,[x]),e=r.a.useState(0),n=Object(f.a)(e,2),o=n[0],i=n[1],d=r.a.useState(0),b=Object(f.a)(d,2),j=b[0],g=b[1],p=r.a.useState(!0),m=Object(f.a)(p,2),O=m[0],v=m[1],I=r.a.useState(100*t.filter(y).length/t.length),V=Object(f.a)(I,2),D=V[0],H=V[1],J=r.a.useState(100*t.filter(w).length/t.length),W=Object(f.a)(J,2),$=W[0],q=W[1],G=function(){var e,n=t.filter(Math.random()<$?w:function(t){return!w(t)}).filter(Math.random()<D?y:function(t){return!y(t)});return(e=n)[z(e.length)]},K=r.a.useState(G()),Q=Object(f.a)(K,2),U=Q[0],X=Q[1],Y=Object(c.useState)({loaded:!1}),Z=Object(f.a)(Y,2),_=Z[0],tt=Z[1],et=r.a.useState({width:window.innerWidth,height:window.innerHeight}),nt=Object(f.a)(et,2),at=nt[0],ct=at.width,rt=at.height,ot=nt[1],it=B(j,h.length),ut=B(o,h.length),lt=Object(C.b)({springRoot:it,springOffset:ut,config:{tension:200,friction:120,mass:10}}),st=lt.springRoot,ft=lt.springOffset,dt=_.loaded&&_.notesToPlay.length>0;r.a.useEffect((function(){var t=function(){return ot({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",t),function(){window.removeEventListener("resize",t)}}),[ot]),r.a.useEffect((function(){var t=function(t){var e=t.key;"Shift"===e&&v(!1),"Enter"===e&&v(!O)},e=function(t){"Shift"===t.key&&v(!0)};return window.addEventListener("keydown",t),window.addEventListener("keyup",e),function(){window.removeEventListener("keydown",t),window.removeEventListener("keyup",e)}}),[O,v]),Object(c.useEffect)((function(){tt({loaded:!0,synth:(new k.a).toDestination(),notesToPlay:[]})}),[tt]),Object(c.useEffect)((function(){if(_.loaded){var t=Object(s.a)(_.notesToPlay),e=t[0],n=t.slice(1);if(dt){var a,c=h[e%h.length];return _.synth.triggerAttack("".concat(c.sharp).concat(e<h.length?pt:pt+1)),a=setInterval((function(){tt(Object(l.a)(Object(l.a)({},_),{},{notesToPlay:n}))}),300),function(){_.synth.triggerRelease(),a&&clearInterval(a)}}}}),[_,dt]);var ht=Math.min(ct-30,rt-30),bt=2*Math.PI/h.length,jt=P.a().padAngle(.1).innerRadius(ht/2.9).outerRadius(ht/2).startAngle((function(t){return(t-.5)*bt})).endAngle((function(t){return(t+.5)*bt})).cornerRadius(ht),gt=r.a.useMemo((function(){return h.map((function(t,e){return jt(e)}))}),[h,jt,bt]),pt=3,mt={"--f":"".concat(ht/50,"pt")},Ot=function(t){_.loaded&&(dt?tt(Object(l.a)(Object(l.a)({},_),{},{notesToPlay:[]})):Object(k.b)().then((function(){return tt(Object(l.a)(Object(l.a)({},_),{},{notesToPlay:t}))})))},vt=U.reduce((function(t,e){return t.concat(t[t.length-1]+e)}),[j]),yt=vt.map((function(t){return t%h.length})),wt=h.map((function(t,e){return yt.includes(e)})),xt=wt.map((function(t,e){return _.loaded&&_.notesToPlay.length>0&&N(_.notesToPlay[0])===e?L:t?R:T})),kt=Object(S.a)(A(Object(S.a)(wt,xt).map((function(t,e){var n=Object(s.a)(t).slice(0);return[e].concat(Object(u.a)(n))})),j-o),gt),Pt=h.map((function(t){return t.sharp===t.flat?t.sharp:"".concat(t.sharp,"/").concat(t.flat).replace(/(\w)#/,"$1\u266f").replace(/(\w)b/,"$1\u266d")})),Ct=A(Object(S.a)(Pt,xt),j);return Object(a.jsxs)("div",{className:"container",style:{"--s":"".concat(ht,"px"),"--m":h.length},children:[Object(a.jsxs)("div",{className:"buttons",children:[Object(a.jsx)("button",{style:mt,onClick:function(){g(z(h.length)),i(0),Ot([])},children:"Randomize Root"}),Object(a.jsx)("button",{style:mt,onClick:function(){return X(G)},children:"Randomize Scale"}),Object(a.jsx)("button",{style:mt,onClick:function(){return Ot(vt)},"aria-pressed":dt,children:dt?"Pause":"Play"}),Object(a.jsxs)("div",{style:{zIndex:1e3},children:[Object(a.jsx)(F.a,{style:Object(l.a)(Object(l.a)({},mt),{},{color:"#999999"}),children:"Click on a note or shift-click on a yellow note."}),Object(a.jsx)(E.a,{checked:!O,onChange:function(t){var e=t.target;return v(!e.checked)},color:"default",size:"medium",inputProps:{"aria-label":"toggle movement mode",role:"switch"}}),Object(a.jsx)(F.a,{children:"Probability of consecutive half-steps"}),Object(a.jsx)(M.a,{value:D,onChange:function(t,e){return H(e)}}),Object(a.jsx)(F.a,{children:"Probability of augmented 2nd"}),Object(a.jsx)(M.a,{value:$,onChange:function(t,e){return q(e)}})]})]}),Object(a.jsxs)(C.a.div,{className:"necklace",style:{"--r":ft.interpolate((function(t){return-t}))},children:[kt.map((function(t,e){var n=Object(f.a)(t,2),c=Object(f.a)(n[0],3),r=c[0],u=c[1],l=c[2],s=n[1];return Object(a.jsx)("svg",{className:"svg",style:{"--c":l},children:Object(a.jsx)("path",{className:"path",stroke:l,d:s,"aria-labelledby":"note".concat(r),role:"button",tabIndex:0,onClick:function(){var t=N(o+(r-j));Ot([]),O?g(r):u&&(i(t),X(A(U,yt.indexOf(r))))}})},e)})),Object(a.jsx)(C.a.div,{className:"note-names",style:{"--a":st.interpolate((function(t){return j-t}))},children:Ct.map((function(t,e){var n=Object(f.a)(t,2),c=n[0],r=n[1];return Object(a.jsx)("span",{style:Object(l.a)({"--i":e,"--c":r},mt),id:"note".concat(j+e),children:c},e)}))})]})]})}var D=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,162)).then((function(e){var n=e.getCLS,a=e.getFID,c=e.getFCP,r=e.getLCP,o=e.getTTFB;n(t),a(t),c(t),r(t),o(t)}))};i.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(V,{})}),document.getElementById("root")),D()}},[[141,1,2]]]);
//# sourceMappingURL=main.3950bfb9.chunk.js.map