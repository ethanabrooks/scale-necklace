(this["webpackJsonpscale-necklace"]=this["webpackJsonpscale-necklace"]||[]).push([[0],{104:function(e,t,n){},123:function(e,t,n){},124:function(e,t,n){"use strict";n.r(t);var a=n(12),r=n(9),c=n.n(r),i=n(43),l=n.n(i),o=(n(104),n(10)),u=n(18),s=n(7),f=n(8),h=n(19),d=[{sharp:"c",flat:"c"},{sharp:"c#",flat:"db"},{sharp:"d",flat:"d"},{sharp:"d#",flat:"eb"},{sharp:"e",flat:"e"},{sharp:"f",flat:"f"},{sharp:"f#",flat:"gb"},{sharp:"g",flat:"g"},{sharp:"g#",flat:"ab"},{sharp:"a",flat:"a"},{sharp:"a#",flat:"bb"},{sharp:"b",flat:"b"}],b=d.length,j="#fca311",p="#e5e5e5",g="#ff4136";function v(e){return Math.floor(Math.random()*e)}function O(e){return e[v(e.length)]}function m(e,t){var n=y(t,e.length);return e.slice(n).concat(e.slice(0,n))}function y(e,t){return(e%t+t)%t}function w(e){return y(e,d.length)}function x(e,t){var n=c.a.useRef(null);if(null==n.current)return n.current=e,e;var a=Math.round((n.current-e)/t)*t+e;return n.current=a,a}var k=function(e,t,n){var a,r=e.filter(I),c=e.filter((function(e){return!I(e)}));if((100*Math.random()<t||0==c.length)&&r.length>0)a=r;else{if(!(c.length>0))return null;0==t&&alert("No adjacent scale without augmented seconds."),a=c}var i=a.filter(A),l=a.filter((function(e){return!A(e)}));return(100*Math.random()<n||0==l.length)&&i.length>0?O(i):l.length>0?(0==n&&alert("No adjacent scale without double half steps."),O(l)):null};function N(e){return 100*F.filter(e).length/F.length}var P=n(35),C=n.n(P);function S(e){return e<=1?[]:Object(h.flatten)([E(e-1).map((function(e){return{head:[1],tail:e}})),E(e-2).map((function(e){return{head:[1,1],tail:e}}))]).map((function(e){return{tag:"A",scale:e}}))}function E(e){return e<=0?[]:Object(h.flatten)([S(e-3).map((function(e){return{head:[3],tail:e}})),R(e-2).map((function(e){return{head:[2],tail:e}})),R(e-5).map((function(e){return{head:[2,3],tail:e}}))]).map((function(e){return{tag:"B",scale:e}}))}function R(e){return e<0?[]:0===e?[{tag:"C",scale:null}]:Object(h.flatten)([S(e),E(e)]).map((function(e){return{tag:"C",scale:e}}))}function T(e){var t=e.scale.head;return null===e.scale.tail?t:t.concat(M(e.scale.tail))}function M(e){var t=e.scale.head;switch(e.scale.tail.tag){case"A":return t.concat(T(e.scale.tail));case"C":return t.concat(L(e.scale.tail))}}function L(e){if(null===e.scale)return[];switch(e.scale.tag){case"A":return T(e.scale);case"B":return M(e.scale)}}function A(e){return Object(h.zip)(e,m(e,1)).some((function(e){var t=Object(f.a)(e,2),n=t[0],a=t[1];return 1===n&&1===a}))}function I(e){return e.some((function(e){return 3===e}))}function z(e,t){return Object(h.zip)(e,t).every((function(e){var t=Object(f.a)(e,2);return t[0]===t[1]}))}function V(e,t,n,a){if(0===e.length||0===t.length)return!1;var r=Object(u.a)(e),c=r[0],i=r.slice(1),l=Object(u.a)(t),o=l[0],s=l.slice(1);if(C()(c===n[n.length-1]),C()(o===a[a.length-1]),c===o){var f,h=Object(u.a)(n),d=h[0],b=h[1],j=h.slice(2),p=Object(u.a)(a),g=p[0],v=p[1],O=p.slice(2);if(d!==b&&d+b===g+v&&(f=z(j,O)),d+b===g&&(f=z(j,[v].concat(O))),g+v===d&&(f=z(O,[b].concat(j))),f)return!0}return V(i,s,m(n,1),m(a,1))}function B(e,t){return V(e,t,m(e,1),m(t,1))}var F=Object(h.flatten)(R(b).map(L).map((function(e){return e.map((function(t,n){return m(e,n)}))})));var D=n(36),H=n(44),J=(n(123),n(29)),W=n(28),$=function(e){var t=e.value,n=e.setValue;return Object(a.jsx)("input",{type:"range",className:"slider",min:0,max:100,step:10,value:t,onChange:function(e){var t=e.target;n(+t.value)}})},q=function(e){var t=e.value,n=e.setValue;return Object(a.jsxs)("label",{className:"switch",children:[Object(a.jsx)("input",{type:"checkbox",onChange:function(){return n(!t)},checked:!t}),Object(a.jsx)("span",{className:"slide"})]})};function G(){var e=c.a.useState(0),t=Object(f.a)(e,2),n=t[0],r=t[1],i=c.a.useState(0),l=Object(f.a)(i,2),h=l[0],b=l[1],O=c.a.useState(!0),y=Object(f.a)(O,2),P=y[0],C=y[1],S=c.a.useState(N(A)),E=Object(f.a)(S,2),R=E[0],T=E[1],M=c.a.useState(N(I)),L=Object(f.a)(M,2),z=L[0],V=L[1],G=c.a.useState(k(F,z,R)),K=Object(f.a)(G,2),Q=K[0],U=K[1],X=c.a.useState({width:window.innerWidth,height:window.innerHeight}),Y=Object(f.a)(X,2),Z=Y[0],_=Z.width,ee=Z.height,te=Y[1],ne=c.a.useMemo((function(){return new D.a}),[]),ae=x(h,d.length),re=x(n,d.length),ce=Object(J.b)({springRoot:ae,springOffset:re,config:{tension:200,friction:120,mass:10}}),ie=ce.springRoot,le=ce.springOffset,oe=c.a.useReducer((function(e,t){if(e.loaded){if("play"===t.type)return Object(s.a)(Object(s.a)({},e),{},{notesToPlay:t.notes});if("nextNote"===t.type){var n=Object(u.a)(e.notesToPlay).slice(1);return Object(s.a)(Object(s.a)({},e),{},{notesToPlay:n})}if("reset"===t.type)return Object(s.a)(Object(s.a)({},e),{},{notesToPlay:[]});throw new Error("Invalid action.type")}return{loaded:!0,notesToPlay:[]}}),{loaded:!1}),ue=Object(f.a)(oe,2),se=ue[0],fe=ue[1],he=se.loaded&&se.notesToPlay.length>0;c.a.useEffect((function(){if(se.loaded){if(he){var e,t=Object(f.a)(se.notesToPlay,1)[0],n=d[t%d.length];return ne.triggerAttack("".concat(n.sharp).concat(t<d.length?3:4)),e=setInterval((function(){fe({type:"nextNote"})}),500),function(){ne.triggerRelease(),e&&clearInterval(e)}}}else ne.toDestination(),fe({type:"reset"})}),[se,ne,he]),c.a.useEffect((function(){var e=function(){return te({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),c.a.useEffect((function(){var e=function(e){var t=e.key;"Shift"===t&&C(!1),"Enter"===t&&C((function(e){return!e}))},t=function(e){"Shift"===e.key&&C(!0)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),function(){window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}}),[C]);var de=Math.min(_-30,ee-30),be=2*Math.PI/d.length,je=H.a().padAngle(.1).innerRadius(de/2.9).outerRadius(de/2).startAngle((function(e){return(e-.5)*be})).endAngle((function(e){return(e+.5)*be})).cornerRadius(de),pe=d.map((function(e,t){return je(t)})),ge=function(e){se.loaded&&(he?fe({type:"reset"}):Object(D.b)().then((function(){return fe({type:"play",notes:e})})))},ve=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.reduce((function(e,t){return e.concat(e[e.length-1]+t)}),[t])}(Q,h),Oe=ve.map((function(e){return e%d.length})),me=d.map((function(e,t){return Oe.includes(t)})),ye=me.map((function(e,t){return se.loaded&&se.notesToPlay.length>0&&w(se.notesToPlay[0])===t?g:e?j:p})),we=Object(W.a)(m(Object(W.a)(me,ye).map((function(e,t){var n=Object(u.a)(e).slice(0);return[t].concat(Object(o.a)(n))})),h-n),pe),xe=d.map((function(e){return e.sharp===e.flat?e.sharp:"".concat(e.sharp,"/").concat(e.flat).replace(/(\w)#/,"$1\u266f").replace(/(\w)b/,"$1\u266d")})),ke=m(Object(W.a)(xe,ye),h);return Object(a.jsxs)("div",{className:"container",style:{"--s":"".concat(de,"px"),"--m":d.length,"--bg":"#222222","--fg":p,"--hl":j,"--ll":"#999999","--pl":g},children:[Object(a.jsxs)("div",{className:"buttons",children:[Object(a.jsx)("button",{className:"button",onClick:function(){b(v(d.length)),r(0),ge([])},children:"Randomize Root"}),Object(a.jsx)("button",{className:"button",onClick:function(){var e=k(F,z,R);null===e?alert("No valid scale."):U(e)},children:"Randomize Scale"}),Object(a.jsx)("button",{className:"button",onClick:function(){var e,t=(e=Q,F.filter((function(t){return B(e,t)}))),n=k(t,z,R);if(null!==n)return U(n);alert("No adjacent scale possible."),console.log(Q)},children:"Random adjacent Scale"}),Object(a.jsx)("button",{className:"button",onClick:function(){return ge(ve)},"aria-pressed":he,children:he?"Pause":"Play"}),Object(a.jsx)("span",{className:"static",children:"Click on a note or shift-click on a yellow note."}),Object(a.jsx)(q,{value:P,setValue:C}),Object(a.jsx)("span",{className:"static",children:"Probability of consecutive half-steps"}),Object(a.jsx)($,{value:R,setValue:T}),Object(a.jsx)("span",{className:"static",children:"Probability of augmented 2nd"}),Object(a.jsx)($,{value:z,setValue:V})]}),Object(a.jsxs)(J.a.div,{className:"necklace",style:{"--r":le.interpolate((function(e){return-e}))},children:[we.map((function(e,t){var c=Object(f.a)(e,2),i=Object(f.a)(c[0],3),l=i[0],o=i[1],u=i[2],s=c[1];return Object(a.jsx)("svg",{className:"svg",style:{"--c":u},children:Object(a.jsx)("path",{className:"path",stroke:u,d:s,"aria-labelledby":"note".concat(l),role:"button",tabIndex:0,onClick:function(){var e=w(n+(l-h));P?b(l):o&&(r(e),U(m(Q,Oe.indexOf(l))))}})},t)})),Object(a.jsx)(J.a.div,{className:"note-names",style:{"--a":ie.interpolate((function(e){return h-e}))},children:ke.map((function(e,t){var n=Object(f.a)(e,2),r=n[0],c=n[1];return Object(a.jsx)("span",{style:{"--i":t,"--c":c},id:"note".concat(h+t),children:r},t)}))})]})]})}var K=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,125)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))};l.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(G,{})}),document.getElementById("root")),K()}},[[124,1,2]]]);
//# sourceMappingURL=main.30cdb2cf.chunk.js.map