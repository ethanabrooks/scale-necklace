(this["webpackJsonpscale-necklace"]=this["webpackJsonpscale-necklace"]||[]).push([[0],{104:function(t,e,n){},123:function(t,e,n){},124:function(t,e,n){"use strict";n.r(e);var a=n(12),c=n(9),r=n.n(c),i=n(43),l=n.n(i),o=(n(104),n(10)),s=n(18),u=n(6),f=n(8),b=n(19),d=[{sharp:"c",flat:"c"},{sharp:"c#",flat:"db"},{sharp:"d",flat:"d"},{sharp:"d#",flat:"eb"},{sharp:"e",flat:"e"},{sharp:"f",flat:"f"},{sharp:"f#",flat:"gb"},{sharp:"g",flat:"g"},{sharp:"g#",flat:"ab"},{sharp:"a",flat:"a"},{sharp:"a#",flat:"bb"},{sharp:"b",flat:"b"}],h=d.length,j="#fca311",p="#e5e5e5",O="#ff4136";function g(t){return Math.floor(Math.random()*t)}function v(t){return t[g(t.length)]}function m(t,e){var n=w(e,t.length);return t.slice(n).concat(t.slice(0,n))}function w(t,e){return(t%e+e)%e}function y(t){return w(t,d.length)}function x(t,e){var n=r.a.useRef(null);if(null==n.current)return n.current=t,t;var a=Math.round((n.current-t)/e)*e+t;return n.current=a,a}var N=function(t,e,n){var a,c=t.filter(I),r=t.filter((function(t){return!I(t)}));if((100*Math.random()<e||0===r.length)&&c.length>0)0===e&&alert("No adjacent scale without augmented seconds."),a=c;else{if(!(r.length>0))return null;a=r}var i=a.filter(A),l=a.filter((function(t){return!A(t)}));return(100*Math.random()<n||0===l.length)&&i.length>0?(0===n&&alert("No adjacent scale without double half steps."),v(i)):l.length>0?v(l):null};function k(t){return 100*F.filter(t).length/F.length}var C=n(35),P=n.n(C);function S(t){return t<=1?[]:Object(b.flatten)([E(t-1).map((function(t){return{head:[1],tail:t}})),E(t-2).map((function(t){return{head:[1,1],tail:t}}))]).map((function(t){return{tag:"A",scale:t}}))}function E(t){return t<=0?[]:Object(b.flatten)([S(t-3).map((function(t){return{head:[3],tail:t}})),R(t-2).map((function(t){return{head:[2],tail:t}})),R(t-5).map((function(t){return{head:[2,3],tail:t}}))]).map((function(t){return{tag:"B",scale:t}}))}function R(t){return t<0?[]:0===t?[{tag:"C",scale:null}]:Object(b.flatten)([S(t),E(t)]).map((function(t){return{tag:"C",scale:t}}))}function T(t){var e=t.scale.head;return null===t.scale.tail?e:e.concat(M(t.scale.tail))}function M(t){var e=t.scale.head;switch(t.scale.tail.tag){case"A":return e.concat(T(t.scale.tail));case"C":return e.concat(L(t.scale.tail))}}function L(t){if(null===t.scale)return[];switch(t.scale.tag){case"A":return T(t.scale);case"B":return M(t.scale)}}function A(t){return Object(b.zip)(t,m(t,1)).some((function(t){var e=Object(f.a)(t,2),n=e[0],a=e[1];return 1===n&&1===a}))}function I(t){return t.some((function(t){return 3===t}))}function z(t,e){return Object(b.zip)(t,e).every((function(t){var e=Object(f.a)(t,2);return e[0]===e[1]}))}function V(t,e,n,a){if(0===t.length||0===e.length)return!1;var c=Object(s.a)(t),r=c[0],i=c.slice(1),l=Object(s.a)(e),o=l[0],u=l.slice(1);if(P()(r===n[n.length-1]),P()(o===a[a.length-1]),r===o){var f,b=Object(s.a)(n),d=b[0],h=b[1],j=b.slice(2),p=Object(s.a)(a),O=p[0],g=p[1],v=p.slice(2);if(d!==h&&d+h===O+g&&(f=z(j,v)),d+h===O&&(f=z(j,[g].concat(v))),O+g===d&&(f=z(v,[h].concat(j))),f)return!0}return V(i,u,m(n,1),m(a,1))}function B(t,e){return V(t,e,m(t,1),m(e,1))}var F=Object(b.flatten)(R(h).map(L).map((function(t){return t.map((function(e,n){return m(t,n)}))})));var D=n(36),H=n(44),J=(n(123),n(29)),W=n(28),$=function(t){var e=t.value,n=t.setValue;return Object(a.jsx)("input",{type:"range",className:"slider",min:0,max:100,step:10,value:e,onChange:function(t){var e=t.target;n(+e.value)}})},q=function(t){var e=t.value,n=t.setValue;return Object(a.jsxs)("label",{className:"switch",children:[Object(a.jsx)("input",{type:"checkbox",onChange:function(){return n(!e)},checked:!e}),Object(a.jsx)("span",{className:"slide"})]})};function G(){var t=r.a.useState(0),e=Object(f.a)(t,2),n=e[0],c=e[1],i=r.a.useState([{root:0,steps:F[0]}]),l=Object(f.a)(i,2),b=l[0],h=l[1],v=r.a.useState(0),w=Object(f.a)(v,2),C=w[0],P=w[1],S=b[C],E=S.root;function R(t){P(b.length),h(b.concat(t))}var T=r.a.useState(!0),M=Object(f.a)(T,2),L=M[0],z=M[1],V=r.a.useState(k(A)),G=Object(f.a)(V,2),K=G[0],Q=G[1],U=r.a.useState(k(I)),X=Object(f.a)(U,2),Y=X[0],Z=X[1],_=r.a.useState({width:window.innerWidth,height:window.innerHeight}),tt=Object(f.a)(_,2),et=tt[0],nt=et.width,at=et.height,ct=tt[1],rt=r.a.useMemo((function(){return new D.a}),[]),it=x(E,d.length),lt=x(n,d.length),ot=Object(J.b)({springRoot:it,springOffset:lt,config:{tension:200,friction:120,mass:10}}),st=ot.springRoot,ut=ot.springOffset,ft=r.a.useReducer((function(t,e){if(t.loaded){if("play"===e.type)return Object(u.a)(Object(u.a)({},t),{},{notesToPlay:e.notes});if("nextNote"===e.type){var n=Object(s.a)(t.notesToPlay).slice(1);return Object(u.a)(Object(u.a)({},t),{},{notesToPlay:n})}if("reset"===e.type)return Object(u.a)(Object(u.a)({},t),{},{notesToPlay:[]});throw new Error("Invalid action.type")}return{loaded:!0,notesToPlay:[]}}),{loaded:!1}),bt=Object(f.a)(ft,2),dt=bt[0],ht=bt[1],jt=dt.loaded&&dt.notesToPlay.length>0;r.a.useEffect((function(){if(dt.loaded){if(jt){var t,e=Object(f.a)(dt.notesToPlay,1)[0],n=d[e%d.length];return rt.triggerAttack("".concat(n.sharp).concat(e<d.length?3:4)),t=setInterval((function(){ht({type:"nextNote"})}),500),function(){rt.triggerRelease(),t&&clearInterval(t)}}}else rt.toDestination(),ht({type:"reset"})}),[dt,rt,jt]),r.a.useEffect((function(){var t=function(){return ct({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",t),function(){window.removeEventListener("resize",t)}}),[]),r.a.useEffect((function(){var t=function(t){var e=t.key;"Shift"===e&&z(!1),"Enter"===e&&z((function(t){return!t}))},e=function(t){"Shift"===t.key&&z(!0)};return window.addEventListener("keydown",t),window.addEventListener("keyup",e),function(){window.removeEventListener("keydown",t),window.removeEventListener("keyup",e)}}),[z]);var pt=Math.min(nt-30,at-30),Ot=2*Math.PI/d.length,gt=H.a().padAngle(.1).innerRadius(pt/2.9).outerRadius(pt/2).startAngle((function(t){return(t-.5)*Ot})).endAngle((function(t){return(t+.5)*Ot})).cornerRadius(pt),vt=d.map((function(t,e){return gt(e)})),mt=function(t){dt.loaded&&(jt?ht({type:"reset"}):Object(D.b)().then((function(){return ht({type:"play",notes:t})})))},wt=S.steps,yt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.reduce((function(t,e){return t.concat(t[t.length-1]+e)}),[e])}(wt,E),xt=yt.map((function(t){return t%d.length})),Nt=d.map((function(t,e){return xt.includes(e)})),kt=Nt.map((function(t,e){return dt.loaded&&dt.notesToPlay.length>0&&y(dt.notesToPlay[0])===e?O:t?j:p})),Ct=Object(W.a)(m(Object(W.a)(Nt,kt).map((function(t,e){var n=Object(s.a)(t).slice(0);return[e].concat(Object(o.a)(n))})),E-n),vt),Pt=d.map((function(t){return t.sharp===t.flat?t.sharp:"".concat(t.sharp,"/").concat(t.flat).replace(/(\w)#/,"$1\u266f").replace(/(\w)b/,"$1\u266d")})),St=m(Object(W.a)(Pt,kt),E);return Object(a.jsxs)("div",{className:"container",style:{"--s":"".concat(pt,"px"),"--m":d.length,"--bg":"#222222","--fg":p,"--hl":j,"--ll":"#999999","--pl":O},children:[Object(a.jsxs)("div",{className:"buttons row absolute",children:[Object(a.jsx)("button",{className:"button",onClick:function(){return P(C-1)},disabled:0===C,children:"\u21e6"}),Object(a.jsx)("button",{className:"button",onClick:function(){return P(C+1)},disabled:C===b.length-1,children:"\u21e8"})]}),Object(a.jsxs)("div",{className:"buttons column flex",children:[Object(a.jsx)("button",{className:"button",onClick:function(){var t=g(d.length);R(Object(u.a)(Object(u.a)({},S),{},{root:t})),c(0),mt([])},children:"Randomize Root"}),Object(a.jsx)("button",{className:"button",onClick:function(){var t=N(F,Y,K);null===t?alert("No valid scale."):R(Object(u.a)(Object(u.a)({},S),{},{steps:t}))},children:"Randomize Scale"}),Object(a.jsx)("button",{className:"button",onClick:function(){var t=function(t){return F.filter((function(e){return B(t,e)}))}(wt),e=N(t,Y,K);null===e?(alert("No adjacent scale possible."),console.log(wt)):R(Object(u.a)(Object(u.a)({},S),{},{steps:e}))},children:"Random adjacent Scale"}),Object(a.jsx)("button",{className:"button",onClick:function(){return mt(yt)},"aria-pressed":jt,children:jt?"Pause":"Play"}),Object(a.jsx)("span",{className:"static",children:"Click on a note or shift-click on a yellow note."}),Object(a.jsx)(q,{value:L,setValue:z}),Object(a.jsx)("span",{className:"static",children:"Probability of consecutive half-steps"}),Object(a.jsx)($,{value:K,setValue:Q}),Object(a.jsx)("span",{className:"static",children:"Probability of augmented 2nd"}),Object(a.jsx)($,{value:Y,setValue:Z})]}),Object(a.jsxs)(J.a.div,{className:"necklace",style:{"--r":ut.interpolate((function(t){return-t}))},children:[Ct.map((function(t,e){var r=Object(f.a)(t,2),i=Object(f.a)(r[0],3),l=i[0],o=i[1],s=i[2],b=r[1];return Object(a.jsx)("svg",{className:"svg",style:{"--c":s},children:Object(a.jsx)("path",{className:"path",stroke:s,d:b,"aria-labelledby":"note".concat(l),role:"button",tabIndex:0,onClick:function(){var t=y(n+(l-E));if(L)R(Object(u.a)(Object(u.a)({},S),{},{root:l}));else if(o){c(t);var e=m(wt,xt.indexOf(l));R(Object(u.a)(Object(u.a)({},S),{},{steps:e}))}}})},e)})),Object(a.jsx)(J.a.div,{className:"note-names",style:{"--a":st.interpolate((function(t){return E-t}))},children:St.map((function(t,e){var n=Object(f.a)(t,2),c=n[0],r=n[1];return Object(a.jsx)("span",{style:{"--i":e,"--c":r},id:"note".concat(E+e),children:c},e)}))})]})]})}var K=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,125)).then((function(e){var n=e.getCLS,a=e.getFID,c=e.getFCP,r=e.getLCP,i=e.getTTFB;n(t),a(t),c(t),r(t),i(t)}))};l.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(G,{})}),document.getElementById("root")),K()}},[[124,1,2]]]);
//# sourceMappingURL=main.540c6eab.chunk.js.map