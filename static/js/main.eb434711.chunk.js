(this["webpackJsonpscale-necklace"]=this["webpackJsonpscale-necklace"]||[]).push([[0],{122:function(t,e,n){},136:function(t,e,n){},141:function(t,e,n){"use strict";n.r(e);var a=n(16),c=n(7),r=n.n(c),i=n(30),o=n.n(i),l=(n(122),n(11)),u=n(8),s=n(50),f=n(10),d=n(33),h=[{sharp:"c",flat:"c"},{sharp:"c#",flat:"db"},{sharp:"d",flat:"d"},{sharp:"d#",flat:"eb"},{sharp:"e",flat:"e"},{sharp:"f",flat:"f"},{sharp:"f#",flat:"gb"},{sharp:"g",flat:"g"},{sharp:"g#",flat:"ab"},{sharp:"a",flat:"a"},{sharp:"a#",flat:"bb"},{sharp:"b",flat:"b"}];function b(t){return t<=1?[]:Object(d.flatten)([j(t-1).map((function(t){return{head:[1],tail:t}})),j(t-2).map((function(t){return{head:[1,1],tail:t}}))]).map((function(t){return{tag:"A",scale:t}}))}function j(t){return t<=0?[]:Object(d.flatten)([b(t-3).map((function(t){return{head:[3],tail:t}})),g(t-2).map((function(t){return{head:[2],tail:t}})),g(t-5).map((function(t){return{head:[2,3],tail:t}}))]).map((function(t){return{tag:"B",scale:t}}))}function g(t){return t<0?[]:0===t?[{tag:"C",scale:null}]:Object(d.flatten)([b(t),j(t)]).map((function(t){return{tag:"C",scale:t}}))}function p(t){var e=t.scale.head;return null===t.scale.tail?e:e.concat(m(t.scale.tail))}function m(t){var e=t.scale.head;switch(t.scale.tail.tag){case"A":return e.concat(p(t.scale.tail));case"C":return e.concat(O(t.scale.tail))}}function O(t){if(null===t.scale)return[];switch(t.scale.tag){case"A":return p(t.scale);case"B":return m(t.scale)}}function v(t){return Object(d.zip)(t,t.slice(1)).some((function(t){var e=Object(f.a)(t,2),n=e[0],a=e[1];return 1===n&&1===a}))}function y(t){return t.some((function(t){return 3===t}))}var w=g(h.length).map(O),x=[[w.filter((function(t){return!v(t)&&!y(t)})),w.filter((function(t){return v(t)&&!y(t)}))],[w.filter((function(t){return!v(t)&&y(t)})),w.filter((function(t){return v(t)&&y(t)}))]],k=100*w.filter(v).length/w.length,P=100*w.filter(y).length/w.length,C=n(51),S=n(59),E=(n(136),n(42)),T=n(43),R=n(159),L=n(160),M=getComputedStyle(document.documentElement).getPropertyValue("--hl"),z=getComputedStyle(document.documentElement).getPropertyValue("--ll"),A=getComputedStyle(document.documentElement).getPropertyValue("--pl");function I(t){return Math.floor(Math.random()*t)}function N(t,e){var n=B(e,t.length);return t.slice(n).concat(t.slice(0,n))}function B(t,e){return(t%e+e)%e}function F(t){return B(t,h.length)}function V(t,e){var n=r.a.useRef(null);if(null==n.current)return n.current=t,t;var a=Math.round((n.current-t)/e)*e+t;return n.current=a,a}var D=n(157);function H(){var t=r.a.useState(0),e=Object(f.a)(t,2),n=e[0],i=e[1],o=r.a.useState(0),d=Object(f.a)(o,2),b=d[0],j=d[1],g=r.a.useState(!0),p=Object(f.a)(g,2),m=p[0],O=p[1],v=r.a.useState(k),y=Object(f.a)(v,2),w=y[0],B=y[1],H=r.a.useState(P),J=Object(f.a)(H,2),W=J[0],$=J[1],q=function(){var t,e=Math.random()<W?1:0,n=Math.random()<w?1:0,a=x[e][n];return(t=a)[I(t.length)]},G=r.a.useState(q()),K=Object(f.a)(G,2),Q=K[0],U=K[1],X=Object(c.useState)({loaded:!1}),Y=Object(f.a)(X,2),Z=Y[0],_=Y[1],tt=r.a.useState({width:window.innerWidth,height:window.innerHeight}),et=Object(f.a)(tt,2),nt=et[0],at=nt.width,ct=nt.height,rt=et[1],it=V(b,h.length),ot=V(n,h.length),lt=Object(E.b)({springRoot:it,springOffset:ot,config:{tension:200,friction:120,mass:10}}),ut=lt.springRoot,st=lt.springOffset,ft=Z.loaded&&Z.notesToPlay.length>0;r.a.useEffect((function(){var t=function(){return rt({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",t),function(){window.removeEventListener("resize",t)}}),[rt]),r.a.useEffect((function(){var t=function(t){var e=t.key;"Shift"===e&&O(!1),"Enter"===e&&O(!m)},e=function(t){"Shift"===t.key&&O(!0)};return window.addEventListener("keydown",t),window.addEventListener("keyup",e),function(){window.removeEventListener("keydown",t),window.removeEventListener("keyup",e)}}),[m,O]),Object(c.useEffect)((function(){_({loaded:!0,synth:(new C.a).toDestination(),notesToPlay:[]})}),[_]),Object(c.useEffect)((function(){if(Z.loaded){var t=Object(s.a)(Z.notesToPlay),e=t[0],n=t.slice(1);if(ft){var a,c=h[e%h.length];return Z.synth.triggerAttack("".concat(c.sharp).concat(e<h.length?dt:dt+1)),a=setInterval((function(){_(Object(u.a)(Object(u.a)({},Z),{},{notesToPlay:n}))}),300),function(){Z.synth.triggerRelease(),a&&clearInterval(a)}}}}),[Z,ft]);var dt=3,ht=Math.min(at-30,ct-30),bt="".concat(ht/50,"pt"),jt=2*Math.PI/h.length,gt={"--f":bt},pt=function(t){Z.loaded&&(ft?_(Object(u.a)(Object(u.a)({},Z),{},{notesToPlay:[]})):Object(C.b)().then((function(){return _(Object(u.a)(Object(u.a)({},Z),{},{notesToPlay:t}))})))},mt=Q.reduce((function(t,e){return t.concat(t[t.length-1]+e)}),[b]),Ot=mt.map((function(t){return t%h.length})),vt=h.map((function(t,e){return Ot.includes(e)})),yt=vt.map((function(t,e){return Z.loaded&&Z.notesToPlay.length>0&&F(Z.notesToPlay[0])===e?A:t?M:z})),wt=S.a().padAngle(.1).innerRadius(ht/2.9).outerRadius(ht/2).startAngle((function(t){return(t-.5)*jt})).endAngle((function(t){return(t+.5)*jt})).cornerRadius(ht),xt=h.map((function(t,e){return wt(e)})),kt=Object(T.a)(N(Object(T.a)(vt,yt).map((function(t,e){var n=Object(s.a)(t).slice(0);return[e].concat(Object(l.a)(n))})),b-n),xt),Pt=h.map((function(t){return t.sharp===t.flat?t.sharp:"".concat(t.sharp,"/").concat(t.flat).replace(/(\w)#/,"$1\u266f").replace(/(\w)b/,"$1\u266d")})),Ct=N(Object(T.a)(Pt,yt),b);return Object(a.jsxs)("div",{className:"container",style:{"--s":"".concat(ht,"px"),"--m":h.length},children:[Object(a.jsxs)("div",{className:"buttons",children:[Object(a.jsx)("button",{style:gt,onClick:function(){j(I(h.length)),i(0),pt([])},children:"Randomize Root"}),Object(a.jsx)("button",{style:gt,onClick:function(){return U(q)},children:"Randomize Scale"}),Object(a.jsx)("button",{style:gt,onClick:function(){return pt(mt)},"aria-pressed":ft,children:ft?"Pause":"Play"}),Object(a.jsxs)("div",{style:{zIndex:1e3},children:[Object(a.jsx)(D.a,{style:Object(u.a)(Object(u.a)({},gt),{},{color:"#999999"}),children:"Try clicking on a note or shift-clicking on yellow note."}),Object(a.jsx)(R.a,{checked:!m,onChange:function(t){var e=t.target;return O(!e.checked)},color:"default",size:"medium",inputProps:{"aria-label":"toggle movement mode",role:"switch"}}),Object(a.jsx)(D.a,{children:"Probability of sampling scale with 2 consecutive half-steps"}),Object(a.jsx)(L.a,{value:w,onChange:function(t,e){return B(e)}}),Object(a.jsx)(D.a,{children:"Probability of sampling scale with augmented 2nd"}),Object(a.jsx)(L.a,{value:W,onChange:function(t,e){return $(e)}})]})]}),Object(a.jsxs)(E.a.div,{className:"necklace",style:{"--r":st.interpolate((function(t){return-t}))},children:[kt.map((function(t,e){var c=Object(f.a)(t,2),r=Object(f.a)(c[0],3),o=r[0],l=r[1],u=r[2],s=c[1];return Object(a.jsx)("svg",{className:"svg",style:{"--c":u},children:Object(a.jsx)("path",{className:"path",stroke:u,d:s,"aria-labelledby":"note".concat(o),role:"button",tabIndex:0,onClick:function(){var t=F(n+(o-b));pt([]),m?j(o):l&&(i(t),U(N(Q,Ot.indexOf(o))))}})},e)})),Object(a.jsx)(E.a.div,{className:"note-names",style:{"--a":ut.interpolate((function(t){return b-t}))},children:Ct.map((function(t,e){var n=Object(f.a)(t,2),c=n[0],r=n[1];return Object(a.jsx)("span",{style:Object(u.a)({"--i":e,"--c":r},gt),id:"note".concat(b+e),children:c},e)}))})]})]})}var J=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,162)).then((function(e){var n=e.getCLS,a=e.getFID,c=e.getFCP,r=e.getLCP,i=e.getTTFB;n(t),a(t),c(t),r(t),i(t)}))};o.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(H,{})}),document.getElementById("root")),J()}},[[141,1,2]]]);
//# sourceMappingURL=main.eb434711.chunk.js.map